["<p>[ ] MoveUp, MoveDown 怎麼無效?</p><div>[ ] 需要甚麼方法可以在檔案前後、檔案之間跳躍。<br>[ ] Editbox 需要區份 [Save][Save &amp; Close] 兩個 button。因為 Editbox 比較特殊，它會跳到 target 處去,所以然。</div><div>&nbsp;</div><p>&nbsp;: edit-zone-moveup ( id -- ) \\ Move the edit-zone up before its previousSibling<br>&nbsp;&nbsp;edit-zone :&gt; [pop()] ( DIV ) <br>&nbsp;&nbsp;dup :&gt; previousSibline ( DIV previous ) <br>&nbsp;&nbsp;?dup if insertBefore else drop then ;</p><p>&nbsp;: edit-zone-movedown ( id -- ) \\ Move the edit-zone down under its nextSibling<br>&nbsp;&nbsp;edit-zone :&gt; [pop()] ( DIV ) <br>&nbsp;&nbsp;dup :&gt; nextSibline ( DIV next ) <br>&nbsp;&nbsp;?dup if insertAfter else drop then ;<br><br><br>&gt; edit-zone (see)<br>[object Object]<br> &nbsp;edit-zone-log.html :  &nbsp;[object HTMLDivElement]<br><br>&gt; char edit-zone-log.html edit-zone :&gt; [pop()] .s<br> &nbsp; &nbsp; &nbsp;0: [object HTMLDivElement] (object)&nbsp; &lt;---------------- log.html 整個 file in it<br> OK <br>&gt; dup previousSibline .s<br>Error! previousSibline unknown.<br> &nbsp; &nbsp; &nbsp;0: [object HTMLDivElement] (object)<br> &nbsp; &nbsp; &nbsp;1: [object HTMLDivElement] (object)<br>&nbsp;<br>&gt; .s<br> &nbsp; &nbsp; &nbsp;0: [object HTMLDivElement] (object)<br> &nbsp; &nbsp; &nbsp;1: [object HTMLDivElement] (object)<br> OK <br>&gt; dup :&gt; previousSibline .s<br> &nbsp; &nbsp; &nbsp;0: [object HTMLDivElement] (object)<br> &nbsp; &nbsp; &nbsp;1: [object HTMLDivElement] (object)<br> &nbsp; &nbsp; &nbsp;2: undefined (undefined)<br> OK <br>&gt; open<br> OK </p><p><br>&gt; open<br> OK <br>&gt; edit-zone (see)<br>[object Object]<br> &nbsp;edit-zone-test.html :  &nbsp;[object HTMLDivElement]<br> OK <br>&gt; edit-zone :&gt; [\"edit-zone-test.html\"] .<br>[object HTMLDivElement] OK <br>&gt; edit-zone :&gt; [\"edit-zone-test.html\"] :&gt; outerHTML .<br>&lt;div style=\"border: 2px solid white;\"&gt;&lt;p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span style=\"font-size: 2em;\"&gt;test.html&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input onclick=\"vm.push('edit-zone-test.html');vm.execute('edit-zone-save')\" type=\"button\" value=\"Save\"&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input onclick=\"vm.push('edit-zone-test.html');vm.execute('edit-zone-close')\" type=\"button\" value=\"Close\"&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input onclick=\"vm.push('edit-zone-test.html');vm.execute('edit-zone-moveup')\" type=\"button\" value=\"MoveUp\"&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input onclick=\"vm.push('edit-zone-test.html');vm.execute('edit-zone-movedown')\" type=\"button\" value=\"MoveDown\"&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span id=\"edit-zone-test.html-pathname\" style=\"font-size: 0.8em;\"&gt; C:\\Users\\hcche\\Documents\\GitHub\\jeforth.3we\\playground\\test.html&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/p&gt;&lt;hr&gt;&lt;div id=\"edit-zone-test.html\" contentEditable=\"true\"&gt;&lt;/div&gt;&lt;hr&gt;&lt;p&gt;&amp;nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input onclick=\"vm.push('edit-zone-test.html');vm.execute('edit-zone-save')\" type=\"button\" value=\"Save\"&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input onclick=\"vm.push('edit-zone-test.html');vm.execute('edit-zone-close')\" type=\"button\" value=\"Close\"&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input onclick=\"vm.push('edit-zone-test.html');vm.execute('edit-zone-moveup')\" type=\"button\" value=\"MoveUp\"&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input onclick=\"vm.push('edit-zone-test.html');vm.execute('edit-zone-movedown')\" type=\"button\" value=\"MoveDown\"&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/p&gt;&lt;/div&gt; OK </p><div>[ ] 同一個 file open 多次會怎樣? 因為 edit-zone 是以 filename 產生 id 所以無法重複管理。<br>&nbsp;&nbsp;&nbsp; 考慮 open 的過程，還是會把 edit-zone 開出來, 裡面是空的——看起來就很可怕了。</div><div>&nbsp;: open ( -- ) \\ Open a HTML file to edit<br>&nbsp;&nbsp;pickFile ?dup if create-edit-zone then ;<br></div><p>&nbsp;: create-edit-zone ( pathname -- ) \\ Create an edit-zone<br>&nbsp;&nbsp;GetAbsolutePathName dup GetFileName dup char edit-zone- swap + -rot ( id pathname filename )</p><p>先用 id 查看有沒有現成的有的話就跳過 --&gt; 這樣就不會重複開檔</p><p>或者一律為 id 加上八位數字亂數 --&gt; 這樣就可以重複開檔</p><p><br>&nbsp;&nbsp;&lt;text&gt; &lt;div style=\"border: 2px solid white;\"&gt;<br>&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>&nbsp;&nbsp;&nbsp;&lt;span style=\"font-size:2em\"&gt;_filename_&lt;/span&gt;<br>&nbsp;&nbsp;&nbsp;/* &lt;span&gt; to make it an element avoid being erased by er */ <br>&nbsp;&nbsp;&nbsp;&lt;input type=button value=Save&nbsp; onclick=\"vm.push('_id_');vm.execute('edit-zone-save')\" /&gt;<br>&nbsp;&nbsp;&nbsp;&lt;input type=button value=Close onclick=\"vm.push('_id_');vm.execute('edit-zone-close')\" /&gt;<br>&nbsp;&nbsp;&nbsp;&lt;input type=button value=MoveUp onclick=\"vm.push('_id_');vm.execute('edit-zone-moveup')\" /&gt;<br>&nbsp;&nbsp;&nbsp;&lt;input type=button value=MoveDown onclick=\"vm.push('_id_');vm.execute('edit-zone-movedown')\" /&gt;<br>&nbsp;&nbsp;&nbsp;&lt;span id=\"_id_-pathname\" style=\"font-size:0.8em\"&gt; _pathname_&lt;/span&gt;<br>&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>&nbsp;&nbsp;&nbsp;&lt;hr&gt;&lt;div id=\"_id_\" contentEditable=true&gt;&lt;/div&gt;&lt;hr&gt;<br>&nbsp;&nbsp;&nbsp;&lt;p&gt;&amp;nbsp;<br>&nbsp;&nbsp;&nbsp;&lt;input type=button value=Save&nbsp; onclick=\"vm.push('_id_');vm.execute('edit-zone-save')\" /&gt;<br>&nbsp;&nbsp;&nbsp;&lt;input type=button value=Close onclick=\"vm.push('_id_');vm.execute('edit-zone-close')\" /&gt;<br>&nbsp;&nbsp;&nbsp;&lt;input type=button value=MoveUp onclick=\"vm.push('_id_');vm.execute('edit-zone-moveup')\" /&gt;<br>&nbsp;&nbsp;&nbsp;&lt;input type=button value=MoveDown onclick=\"vm.push('_id_');vm.execute('edit-zone-movedown')\" /&gt;<br>&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>&nbsp;&nbsp;&lt;/div&gt;&lt;/text&gt; /*remove*/<br>&nbsp;&nbsp;:&gt; replace(/_filename_/gm,pop()).replace(/_pathname_/gm,pop()).replace(/_id_/gm,tos()) ( id )<br>&nbsp;&nbsp;&lt;/o&gt;<br>&nbsp;&nbsp;ce! er ce@ swap ( ce@ id ) edit-zone :: [tos()]=pop(1) <br>&nbsp;&nbsp;ce@ js&gt; outputbox insertBefore ( id ) edit-zone-load ;<br>&nbsp;&nbsp;/// id is the editing &lt;div&gt;<br></p><p>&nbsp;</p><br>&gt; save<br>"]